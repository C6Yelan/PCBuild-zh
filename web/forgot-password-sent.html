<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <title>重設密碼信已寄出 · PCBuild-zh</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      :root { color-scheme: light dark; }
      :root {
        --surface: Canvas;
        --text: CanvasText;
        --border: color-mix(in srgb, CanvasText 12%, Canvas);
        --muted: color-mix(in srgb, CanvasText 50%, Canvas);
        --success: #22c55e;
        --btn-bg: color-mix(in srgb, CanvasText 5%, Canvas);
        --btn-bg-hover: color-mix(in srgb, CanvasText 10%, Canvas);
      }
      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI",
          "Noto Sans TC", "PingFang TC", "Microsoft JhengHei";
        background: radial-gradient(
          circle at top,
          color-mix(in srgb, CanvasText 5%, Canvas),
          Canvas
        );
        color: var(--text);
      }
      .container {
        width: 100%;
        max-width: 420px;
        padding: 16px;
      }
      .card {
        border-radius: 16px;
        border: 1px solid var(--border);
        background: var(--surface);
        padding: 24px 20px 20px;
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
      }
      .logo {
        font-weight: 700;
        font-size: 22px;
        margin-bottom: 4px;
        text-align: center;
      }
      .title {
        text-align: center;
        font-size: 18px;
        margin: 8px 0 12px;
      }
      .title span {
        color: var(--success);
        font-weight: 700;
      }
      .content {
        font-size: 14px;
        line-height: 1.7;
        color: var(--text);
        opacity: 0.95;
      }
      .content strong {
        font-weight: 700;
      }
      .masked {
        font-weight: 700;
        color: var(--success);
        word-break: break-all;
      }
      .hint {
        margin: 12px 0 0;
        font-size: 13px;
        line-height: 1.7;
        color: var(--muted);
      }
      .actions {
        margin-top: 16px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: center;
      }
      .btn {
        padding: 10px 18px;
        border-radius: 999px;
        border: 1px solid var(--border);
        background: var(--btn-bg);
        color: var(--text);
        text-decoration: none;
        text-align: center;
        min-width: 160px;
      }
      .btn:hover { background: var(--btn-bg-hover); }
      .link {
        font-size: 13px;
        color: inherit;
        text-decoration: underline;
        cursor: pointer;
      }
      .back-home {
        margin-top: 12px;
        text-align: center;
        font-size: 13px;
      }
      .back-home a {
        color: inherit;
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="card">
        <div class="logo">PCBuild-zh</div>
        <div class="title">
          <span>重設密碼信已寄出（若信箱存在）</span>
        </div>

        <div id="content" class="content">
        <span id="msg-prefix">我們已寄出一封「重設密碼」的電子郵件。</span>
        <span id="msg-email-wrap" style="display:none;">
            至 <span id="masked-email" class="masked"></span>。
        </span>
        <span id="msg-suffix">
            若此信箱存在於系統中，請依照信件中的指示在 <strong>20 分鐘內</strong> 完成密碼重設。
        </span>
        </div>


        <p class="hint">
          若你沒有收到信件，請檢查垃圾郵件匣或促銷分類。
        </p>
        <p class="hint">
          為了帳號安全，重設連結逾時即失效；如需再次重設，請回到忘記密碼頁面重新申請。
        </p>

        <div class="actions">
          <a href="/login.html" class="btn">前往登入</a>
          <a href="/forgot-password.html" class="link">回到忘記密碼頁面</a>
        </div>
      </div>

      <div class="back-home">
        <a href="/">回到首頁</a>
      </div>
    </div>

    <script>
      // 從 sessionStorage 讀取上一頁暫存的 email（不放在 URL）
      // sessionStorage 為「分頁/工作階段」層級，關閉分頁即清除。
      function maskEmail(email) {
        const parts = String(email || "").split("@");
        if (parts.length !== 2) return "";
        const local = parts[0];
        const domain = parts[1];
        if (!local || !domain) return "";

        if (local.length <= 2) return `${local}***@${domain}`;
        return `${local.slice(0, 2)}${"*".repeat(local.length - 2)}@${domain}`;
      }

        const emailWrapEl = document.getElementById("msg-email-wrap");
        const maskedEmailEl = document.getElementById("masked-email");

        let email = "";
        try {
        email = sessionStorage.getItem("pcbuild_forgot_email") || "";
        sessionStorage.removeItem("pcbuild_forgot_email"); // 讀取後即清除 
        } catch (e) {
        email = "";
        }

        const masked = maskEmail(email);

        // 若取得到 email，就顯示「至 ab***@domain」那段，並用 textContent 填入
        if (masked) {
        maskedEmailEl.textContent = masked;              // 安全 sink：textContent 
        emailWrapEl.style.display = "";                  // 顯示 email 片段
        }
    </script>
  </body>
</html>
